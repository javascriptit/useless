(function(k){function g(c){if(b[c])return b[c].exports;var a=b[c]={exports:{},id:c,loaded:!1};k[c].call(a.exports,a,a.exports,g);a.loaded=!0;return a.exports}var b={};g.m=k;g.c=b;g.p="";return g(0)})([function(k,g,b){b(1);b(2);b(4);b(5);b(6);b(7);b(8);b(9);b(10);b(11);b(15);document.ready(function(){Panic.init();CallStack.isThirdParty.intercept(function(b,a){return 0<=b.indexOf("underscore")||0<=b.indexOf("jquery")||0<=b.indexOf("useless")||0<=b.indexOf("mootools")})})},function(k,g){_.hasAsserts=
!0;_.extend(_,{tests:{},withTest:function(b,c,a){a();_.runTest(b,c);_.publishToTestsNamespace(b,c)},deferTest:function(b,c,a){a();_.publishToTestsNamespace(b,c)},runTest:function(b,c){try{_.isFunction(c)?c():_.each(c,function(a){a()})}catch(e){if(_.isAssertionError(e)){var a=(_.isArray(b)&&b||[b]).join(".");console.log(a+":",e.message,"\n"+_.times(a.length,_.constant("~")).join("")+"\n");_.each(e.notMatching,function(a){console.log("  \u2022",a)})}throw e;}},publishToTestsNamespace:function(b,c){_.isArray(b)?
(_.tests[b[0]]||(_.tests[b[0]]={}))[b[1]]=c:_.tests[b]=c}});_.deferTest("assert.js bootstrap",function(){$assert(!0);$assert(_.assert===_.assertions.assert);$assertNot(!1);$assertNot(5);$assert(4,4,4);$assert({foo:[1,2,3]},{foo:[1,2,3]});$assert({foo:{bar:1},baz:2},{baz:2,foo:{bar:1}});$assertNot(4,5);$assertMatches({foo:1,bar:2},{foo:1});_.hasStdlib&&$assertMatches({foo:[1,2],bar:3},{foo:[1]});_.hasStdlib&&$assertMatches("123",/[0-9]+/);_.hasStdlib&&($assertTypeMatches(42,"number"),$assertFails(function(){$assertTypeMatches("foo",
"number")}));_.hasStdlib&&($assertTypeMatches([1,2],[]),$assertTypeMatches([],[]),$assertTypeMatches([1,2,3],["number"]),$assertTypeMatches([],["number"]),$assertFails(function(){$assertTypeMatches([1,2,3],["string"]);$assertTypeMatches([1,2,"foo"],["number"])}));_.hasStdlib&&$assertTypeMatches({foo:42,bar:{even:4,many:["foo","bar"]}},{foo:"number",qux:"undefined",bar:{even:function(a){return 0===a%2},many:["string"]}});if(_.hasOOP){var b=$prototype(),c=$prototype();$assertTypeMatches({foo:new b,
bar:new c},{foo:b,bar:c});$assertFails(function(){$assertTypeMatches(new c,b)})}if(_.hasStdlib){var a=function(a,b,c){$assertArguments(arguments)};a(777,"foo bar baz");$assertFails(function(){a(777,42)})}$assertThrows(function(){throw 42;});$assertNotThrows(function(){});$assertThrows(function(){throw 42;},42);$assertThrows(function(){throw Error("42");},_.matches({message:"42"}));$assertFails(function(){$assertThrows(function(){throw 42;},24);$assertThrows(function(){throw Error("42");},_.matches({message:"24"}))});
$assertEveryCalled(function(a,b,c){a();a();b();c()});$assertEveryCalledOnce(function(a,b,c){a();b();c()});$assertEveryCalled(function(a){a();a();a()});_.hasStdlib&&$assertCalledWithArguments(["foo",["foo","bar"]],function(a){a("foo");a("foo","bar")});$assertCPS(function(a){a("foo","bar")},["foo","bar"]);$assertCPS(function(a){a("foo")},"foo");$assertCPS(function(a){a()});$assertFails(function(){$fail;$stub;$assert("not true");$assert({foo:1,bar:2},{foo:1});$assert([1,2,3,4],[1,2,3]);$assert(["foo"],
{0:"foo",length:1});$assertFails(function(){})});$assert===_.assertions.assert&&$assertThrows(function(){$fail})},function(){var b=function(a){return function(b){var c=[].splice.call(arguments,0);1===c.length?a&&!0!==c[0]&&_.assertionFailed({notMatching:c}):a&&!0!==_.allEqual(c)&&_.assertionFailed({notMatching:c});return!0}};$overrideUnderscore("matches",function(a){return function(b){return _.isObject(b)?a(b):function(a){return b===a}}});_.extend(_,_.assertions={assert:b(!0),assertNot:b(!1),assertCPS:function(a,
b,c){var d=b&&(_.isArray(b)?b:[b])||[];a(function(){$assert([].splice.call(arguments,0),d);if(c)return c(),!0})},assertNotCalled:function(a){var b=!0;a(function(){b&&$fail});b=!1},assertEveryCalledOnce:function(a,b){return _.assertEveryCalled(_.hasTags?$once(a):(a.once=!0,a),b)},assertEveryCalled:function(a,b){var c=_.hasTags?$untag(a):a,d=_.hasTags?$async.is(a):a.async,h=(once=_.hasTags?$once.is(a):a.once)?null:c.toString().match(/.*function[^\(]\(([^\)]+)\)/),l=once?_.times(c.length,_.constant(1)):
_.map(h[1].split(","),function(a){a=(a=a.trim().match(/^(.+)__(\d+)$/))&&parseInt(a[2],10);return _.isFinite(a)?a||!1:!0}),g=_.times(c.length,_.constant(!1)),h=_.times(c.length,function(a){return function(){g[a]=_.isNumber(l[a])?(g[a]||0)+1:!0;d&&_.isEqual(g,l)&&b()}});c.apply(null,h);d||(_.assert(g,l),b&&b())},assertCalledWithArguments:function(a,b){return _.assert(_.arr(b),a)},assertCallOrder:function(a){var b=0,c=_.times(a.length,function(a){return function(){arguments.callee.callIndex=b++}});
a.apply(null,c);return _.assert(_.pluck(c,"callIndex"),_.times(c.length,_.identity.arity1))},assertMatches:function(a,b){try{return _.assert(_.matches.apply(null,_.rest(arguments))(a))}catch(c){throw _.isAssertionError(c)?_.extend(c,{notMatching:[a,b]}):c;}},assertNotMatches:function(a,b){try{return _.assert(!_.matches.apply(null,_.rest(arguments))(a))}catch(c){throw _.isAssertionError(c)?_.extend(c,{notMatching:[a,b]}):c;}},assertType:function(a,b){return _.assert(_.decideType(a),b)},assertTypeMatches:function(a,
b){return _.isEmpty(mismatches=_.typeMismatches(b,a))?!0:_.assertionFailed({message:"provided value type not matches required contract",asColumns:!0,notMatching:[{provided:a},{required:b},{mismatches:mismatches}]})},assertFails:function(a){return _.assertThrows.call(this,a,_.isAssertionError)},assertThrows:function(a,b){var c=void 0,d=!1;try{a.call(this)}catch(h){c=h,d=!0}_.assert.call(this,d);1<arguments.length&&_.assertMatches.call(this,c,b)},assertNotThrows:function(a){return _.assertEveryCalled(function(b){a();
b()})},assertArguments:function(a,b,c){b=(b||a.callee).toString();var d=b.match(/.*function[^\(]\(([^\)]+)\)/);if(d){a=_.asArray(a);var d=_.map(d[1].split(","),function(a){a="_"===a.trim()[0]?a.replace(/_/g," ").trim():void 0;var b=parseInt(a,10);return _.isFinite(b)?b:a}),h=_.zipWith([d,a],function(a,b){return void 0===a?!0:a===b});_.every(h)||_.assertionFailed({notMatching:_.nonempty([[c,b].join(": "),d,a])})}},fail:function(){_.assertionFailed()},fails:_.constant(function(){_.assertionFailed()}),
stub:function(){_.assertionFailed()}});_.extend(_,{assertionError:function(a){return _.extend(Error(a&&a.message||"assertion failed"),a,{assertion:!0})},assertionFailed:function(a){throw _.extend(_.assertionError(a),{stack:_.rest(Error().stack.split("\n"),3).join("\n")});},isAssertionError:function(a){return a&&!0===a.assertion}});_.extend(_,{allEqual:function(a){return _.reduce(a,function(b,c){return b&&_.isEqual(a[0],c)},!0)}});_.each(_.keys(_.assertions),function(a){$global.define("$"+a,_[a],{configurable:!0})});
for(var c in _.assertions)$global["$"+c]=1;$assert})},function(k,g,b){(function(){_.hasUncaught=!0;var c=_.globalUncaughtExceptionHandler=function(a){var b=arguments.callee.chain;arguments.callee.chain=_.reject(b,_.property("catchesOnce"));if(b.length)for(var c=0,d=b.length;c<d;c++)try{b[c](a);break}catch(h){console.log(h);if(c===d-1)throw h.message+=" [re-thrown by a hook]",h;h&&"object"===typeof h&&(h.originalError=a);a=h}else throw a.message+=" [re-thrown by a hook]",a;};_.withUncaughtExceptionHandler=
function(a,b){var f=b||_.identity;b&&(a.catchesOnce=!0);c.chain.unshift(a);f(function(){c.chain.remove(a)})};c.chain=[];switch($platform.engine){case "node":b(3).on("uncaughtException",c);break;case "browser":window.addEventListener("error",function(a){0>a.message.indexOf(" [re-thrown by a hook]")&&(a.error?c(a.error):c(_.extend(Error(a.message),{stub:!0,stack:"at "+a.filename+":"+a.lineno+":"+a.colno})))})}})()},function(k,g){function b(){h=!1;l.length?d=l.concat(d):m=-1;d.length&&c()}function c(){if(!h){var a=
setTimeout(b);h=!0;for(var c=d.length;c;){l=d;for(d=[];++m<c;)l&&l[m].run();m=-1;c=d.length}l=null;h=!1;clearTimeout(a)}}function a(a,b){this.fun=a;this.array=b}function e(){}var f=k.exports={},d=[],h=!1,l,m=-1;f.nextTick=function(b){var e=Array(arguments.length-1);if(1<arguments.length)for(var f=1;f<arguments.length;f++)e[f-1]=arguments[f];d.push(new a(b,e));1!==d.length||h||setTimeout(c,0)};a.prototype.run=function(){this.fun.apply(null,this.array)};f.title="browser";f.browser=!0;f.env={};f.argv=
[];f.version="";f.versions={};f.on=e;f.addListener=e;f.once=e;f.off=e;f.removeListener=e;f.removeAllListeners=e;f.emit=e;f.binding=function(a){throw Error("process.binding is not supported");};f.cwd=function(){return"/"};f.chdir=function(a){throw Error("process.chdir is not supported");};f.umask=function(){return 0}},function(k,g){(function(){if($platform.Browser){_.hasUncaughtAsync=!0;var b=void 0,c=function(a,c){return __supressErrorReporting=function(){var f={name:name,stack:Error().stack,asyncContext:b},
d=_.asArray(arguments),h=d[c];if(!_.isFunction(h))throw Error("[uncaughtAsync.js] callback should be a function");h.__uncaughtJS_wrapper=d[c]=__supressErrorReporting=function(){b=f;try{return h.apply(this,arguments)}catch(a){_.globalUncaughtExceptionHandler(_.extend(a,{asyncContext:f}))}};return a.apply(this,d)}};window.setTimeout=c(window.setTimeout,0);(function(a,b){var c=function(c){c.addEventListener=a(c.addEventListener);c.removeEventListener=b(c.removeEventListener)};window.EventTarget?c(window.EventTarget.prototype):
(c(Node.prototype),c(XMLHttpRequest.prototype))})(function(a){return c(a,1)},function(a){return function(b,c,d,h){return a.call(this,b,c.__uncaughtJS_wrapper||c,d)}})}})()},function(k,g,b){(function(c){_.hasReflection=!0;_.tests.reflection={"file paths":function(){$assert(0<$sourcePath.length);$assert(0<$uselessPath.length)},readSource:function(){var a=$uselessPath+$uselessFile;SourceFiles.read(a,function(a){$assert(0<a.length)});SourceFiles.line(a,0,function(a){$assert(0<a.length)})},"CallStack from error":function(){try{throw Error("oh fock");
}catch(a){$assertTypeMatches(CallStack.fromError(a),CallStack)}},$callStack:function(a){var b=$callStack;$assert(_.isArray(b));$assertTypeMatches(b[0],{callee:"string",calleeShort:"string",file:"string",fileName:"string",fileShort:"string",thirdParty:"boolean",index:"boolean","native":"boolean",line:"number",column:"number",source:"string",sourceReady:"function"});$assert(_.isTypeOf(CallStack,b));$assert(_.isTypeOf(CallStack,b.clean));$assert(_.isTypeOf(CallStack,b.offset(2)));$assert(_.isTypeOf(CallStack,
b.filter(_.identity)));$assert(_.isTypeOf(CallStack,b.reject(_.identity)));$assertEveryCalled($async(function(a,c,h){b[0].sourceReady(function(b){$assert(typeof b,"string");a()});b.sourcesReady(function(){_.each(b,function(a){$assert(typeof a.source,"string")});c()});b.safeLocation(7777).sourceReady(function(a){$assert("??? WRONG LOCATION ???",a);h()})}),a)},"Prototype.$meta":function(a){$prototype().$meta(function(b){$assertMatches(b,{name:"Dummy",type:"prototype"});a()})},"Trait.$meta":function(a){$trait().$meta(function(b){$assertMatches(b,
{name:"Dummy",type:"trait"});a()})}};_.defineKeyword("callStack",function(){return CallStack.fromRawString(CallStack.currentAsRawString).offset($platform.NodeJS?1:0)});_.defineKeyword("currentFile",function(){return(CallStack.rawStringToArray(CallStack.currentAsRawString)[$platform.NodeJS?3:1]||{file:""}).file});_.defineKeyword("uselessPath",_.memoize(function(){return _.initial(c.split("/"),$platform.NodeJS?2:1).join("/")+"/"}));_.defineKeyword("sourcePath",_.memoize(function(){var a=($uselessPath.match(/(.+)\/node_modules\/(.+)/)||
[])[1];return a?a+"/":$uselessPath}));$platform.Browser&&_.defineProperty(window,"__filename",function(){return $currentFile});SourceFiles=$singleton(Component,{line:function(a,b,c){SourceFiles.read(a,function(a){c((a.split("\n")[b]||"").trimmed)})},read:$memoizeCPS(function(a,c){if(0>a.indexOf("<"))try{if($platform.NodeJS)c(b(!function(){var a=Error('Cannot find module "fs"');a.code="MODULE_NOT_FOUND";throw a;}()).readFileSync(a,{encoding:"utf8"})||"");else{var f=new XMLHttpRequest;f.open("GET",
a,!0);f.onreadystatechange=function(){4==f.readyState&&c(f.responseText)};f.send(null)}}catch(d){c("")}else c("")}),write:function(a,b,c){$platform.NodeJS?this.read(a,function(a){a=Error('Cannot find module "fs"');a.code="MODULE_NOT_FOUND";throw a;}):JSONAPI.post("source/"+a,_.extend2({},this.apiConfig,{what:{text:b}})).then(function(){log.ok(a,"\u2014 successfully saved");c&&c()})}});CallStack=$extends(Array,{current:$static($property(function(){return CallStack.fromRawString(CallStack.currentAsRawString).offset(1)})),
fromError:$static(function(a){return a&&a.parsedStack?CallStack.fromParsedArray(a.parsedStack).offset(a.stackOffset||0):a&&a.stack?CallStack.fromRawString(a.stack).offset(a.stackOffset||0):CallStack.fromParsedArray([])}),fromErrorWithAsync:$static(function(a){var b=CallStack.fromError(a);for(a=a.asyncContext;a;)b=b.concat(CallStack.fromRawString(a.stack)),a=a.asyncContext;return b.mergeDuplicateLines}),locationEquals:$static(function(a,b){return a.file===b.file&&a.line===b.line&&a.column===b.column}),
safeLocation:function(a){return this[a]||{callee:"",calleeShort:"",file:"",fileName:"",fileShort:"",thirdParty:!1,source:"??? WRONG LOCATION ???",sourceReady:_.barrier("??? WRONG LOCATION ???")}},mergeDuplicateLines:$property(function(){return CallStack.fromParsedArray(_.map(_.partition2(this,function(a){return a.file+a.line}),function(a){return _.reduce(_.rest(a),function(a,b){a.callee=(a.callee||"<anonymous>")+" \u2192 "+(b.callee||"<anonymous>");a.calleeShort=(a.calleeShort||"<anonymous>")+" \u2192 "+
(b.calleeShort||"<anonymous>");return a},_.clone(a[0]))}))}),clean:$property(function(){var a=this.mergeDuplicateLines.reject(function(a,b){return(a.thirdParty||a.hide)&&0!==b});return 0===a.length?this:a}),asArray:$property(function(){return _.asArray(this)}),offset:function(a){return a&&CallStack.fromParsedArray(_.rest(this,a))||this},initial:function(a){return a&&CallStack.fromParsedArray(_.initial(this,a))||this},concat:function(a){return CallStack.fromParsedArray(this.asArray.concat(a.asArray))},
filter:function(a){return CallStack.fromParsedArray(_.filter(this,a))},reject:function(a){return CallStack.fromParsedArray(_.reject(this,a))},reversed:$property(function(){return CallStack.fromParsedArray(_.reversed(this))}),sourcesReady:function(a){return _.allTriggered(_.pluck(this,"sourceReady"),a)},constructor:function(a){Array.prototype.constructor.call(this);_.each(a,function(a){a.sourceReady||(a.sourceReady=_.barrier(),SourceFiles.line((a.remote?"api/source/":"")+a.file,a.line-1,function(b){a.hide=
b.contains("// @hide");a.sourceReady(a.source=b.replace("// @hide",""))}));this.push(a)},this)},fromParsedArray:$static(function(a){return new CallStack(a)}),currentAsRawString:$static($property(function(){var a=$platform.Browser?3:2;return _.rest((Error().stack||"").split("\n"),a).join("\n")})),shortenPath:$static(function(a){var b=a.replace($uselessPath,"").replace($sourcePath,"");return b!==a?b.replace(/^node_modules\//,""):a.split("/").last}),isThirdParty:$static(_.bindable(function(a){var b=
a.replace($sourcePath,"");return $platform.NodeJS&&"/"!==a[0]||0<=b.indexOf("/node_modules/")||0<=a.indexOf("/node_modules/")&&!b||0<=b.indexOf("underscore")||0<=b.indexOf("jquery")})),fromRawString:$static(_.sequence(function(a){return CallStack.rawStringToArray(a)},function(a){return _.map(a,function(a){return _.extend(a,{calleeShort:_.last(a.callee.split(".")),fileName:_.last(a.file.split("/")),fileShort:CallStack.shortenPath(a.file),thirdParty:CallStack.isThirdParty(a.file)&&!a.index})})},function(a){return CallStack.fromParsedArray(a)})),
rawStringToArray:$static(function(a){a=(a||"").split("\n");return _.filter2(a,function(a){a=a.trimmed;var b,c,h=!1;if((c=a.match(/at (.+) \((.+)\)/))||(c=a.match(/(.*)@(.*)/)))b=c[1],h="native"===c[2],c=_.rest(c[2].match(/(.*):(.+):(.+)/)||[]);else if(c=a.match(/^(at\s+)*(.+):([0-9]+):([0-9]+)/))c=_.rest(c,2);else return!1;return 0<=(b||"").indexOf("__supressErrorReporting")?!1:{beforeParse:a,callee:b||"",index:$platform.Browser&&c[0]===window.location.href,"native":h,file:c[0]||"",line:(c[1]||"").integerValue,
column:(c[2]||"").integerValue}})})});$prototype.impl.findMeta=function(a){return function(b){_.cps.find(CallStack.fromRawString(a).reversed,function(a,b){a.sourceReady(function(c){c=(c||"").match(/([A-z]+)\s*=\s*\$(prototype|singleton|component|extends|trait|aspect)/);b(c&&{name:c[1],type:c[2],file:a.fileShort}||!1)})},function(a){b(a||{})})}};$prototype.macro(function(a,b){if(!a.$meta){var c=_.cps.memoize($prototype.impl.findMeta(CallStack.currentAsRawString));_.defineMemoizedProperty(c,"promise",
function(){return new Promise(c)});a.$meta=$static(c)}return a})}).call(g,"/index.js")},function(k,g){_.hasLog=!0;_.tests.log={basic:function(){log("log (x)");log.green("log.green");log.boldGreen("log.boldGreen");log.darkGreen("log.darkGreen");log.blue("log.blue");log.boldBlue("log.boldBlue");log.darkBlue("log.darkBlue");log.orange("log.orange");log.boldOrange("log.boldOrange");log.darkOrange("log.darkOrange");log.red("log.red");log.boldRed("log.boldRed");log.darkRed("log.darkRed");log.pink("log.pink");
log.boldPink("log.boldPink");log.darkPink("log.darkPink");log.margin();log.margin();log.bright("log.bright");log.dark("log.dark");log.margin();log.success("log.success");log.ok("log.ok");log.g("log.g");log.gg("log.gg");log.info("log.info");log.i("log.i");log.ii("log.ii");log.warning("log.warning");log.warn("log.warn");log.w("log.w");log.ww("log.ww");log.error("log.error");log.e("log.e");log.ee("log.ee");$assert(log("log (x) === x"),"log (x) === x");log.info(log.stackOffset(2),"log.info (log.config ({ stackOffset: 2 }), ...)");
log.write("Consequent","arguments",log.color.red," joins","with","whitespace");log.write("Multi",log.color.red,"Colored",log.color.green,"Output",log.color.blue,"For",log.color.orange,"The",log.color.pink,"Fucking",log.color.none,"Win");log.write(log.boldLine);log.write(log.thinLine);log.write(log.line);log.write(log.indent(1),"You can set indentation\nthat is nicely handled\nin case of multiline text");log.orange(log.indent(2),"\nCan print nice table layout view for arrays of objects:\n");log.orange(log.config({indent:2,
table:!0}),[{field:"line",matches:!1,valueType:"string",contractType:"number"},{field:"column",matches:!0,valueType:"string",contractType:"number"}]);log.write("\nObject:",{foo:1,bar:2,qux:3});log.write("Array:",[1,2,3]);log.write("Function:",_.identity);log.write("Complex object:",{foo:1,bar:{qux:[1,2,3],garply:_.identity}},"\n\n");log.withConfig(log.indent(1),function(){log.pink("Config stack + scopes + higher order API test:");_.each([5,6,7],logs.pink(log.indent(1),"item = ",log.color.blue))});
$assert(log(42),42)}};_.extend(log=function(){return log.write.apply(this,[log.config({location:!0,stackOffset:1})].concat(_.asArray(arguments)))},{Config:$prototype(),config:function(b){return new log.Config(b)}});_.extend(log,{indent:function(b){return log.config({indent:b})},stackOffset:function(b){return log.config({stackOffset:b})},where:function(b){return log.config({location:!0,where:b||void 0})},color:_.extend(function(b){return(log.color[b]||{}).color},_.object(_.map([["none","0m",""],["red",
"31m","color:crimson"],["boldRed",["31m","1m"],"color:crimson;font-weight:bold"],["darkRed",["31m","2m"],"color:crimson"],["blue","36m","color:royalblue"],["boldBlue",["36m","1m"],"color:royalblue;font-weight:bold;"],["darkBlue",["36m","2m"],"color:rgba(65,105,225,0.5)"],["boldOrange",["33m","1m"],"color:saddlebrown;font-weight:bold;"],["darkOrange",["33m","2m"],"color:saddlebrown"],["orange","33m","color:saddlebrown"],["brown",["33m","2m"],"color:saddlebrown"],["green","32m","color:forestgreen"],
["boldGreen",["32m","1m"],"color:forestgreen;font-weight:bold"],["darkGreen",["32m","2m"],"color:forestgreen;opacity:0.5"],["pink","35m","color:magenta"],["boldPink",["35m","1m"],"color:magenta;font-weight:bold;"],["darkPink",["35m","2m"],"color:magenta"],["black","0m","color:black"],["bright",["0m","1m"],"color:rgba(0,0,0);font-weight:bold"],["dark",["0m","2m"],"color:rgba(0,0,0,0.25)"]],function(b){return[b[0],log.config({color:{shell:_.coerceToArray(_.map2(b[1],_.prepends("\u001b["))).join(),css:b[2]}})]}))),
boldLine:"======================================",line:"--------------------------------------",thinLine:"......................................",timestampEnabled:!1,withWriteBackend:$scope(function(b,c,a,e){var f=log.writeBackend.value;log.writeBackend.value=c;a(function(a){b(function(){log.writeBackend.value=f;a&&a();e&&e()})})}),writeUsingDefaultBackend:function(){var b=arguments;log.withWriteBackend(log.impl.defaultWriteBackend,function(c){log.write.apply(null,b);c()})},writeBackend:function(){return arguments.callee.value||
log.impl.defaultWriteBackend},withConfig:function(b,c){log.impl.configStack.push(log.impl.configure([{stackOffset:-1},b]));var a=c();log.impl.configStack.pop();return a},currentConfig:function(){return log.impl.configure(log.impl.configStack)},margin:function(){var b=void 0;return function(){b!==log.impl.numWrites&&log.newline();b=log.impl.numWrites}}(),impl:{configStack:[],numWrites:0,configure:function(b){return _.reduce2({stackOffset:0,indent:0},_.nonempty(b),function(b,a){return _.extend(b,_.nonempty(a),
{indent:b.indent+(a.indent||0),stackOffset:b.stackOffset+(a.stackOffset||0)})})},write:$restArg(_.bindable(function(){var b=log.writeBackend();log.impl.numWrites++;var c=_.asArray(arguments),a=log.impl.configure([{stackOffset:$platform.NodeJS?1:3,indent:b.indent||0}].concat(log.impl.configStack)),e=_.reduce2([],_.partition3(c,_.isTypeOf.$(log.Config)),function(b,c){return!0===c.label?(a=log.impl.configure([a].concat(c.items)),b):b.concat({config:a,text:log.impl.stringifyArguments(c.items,a)})}),f=
e.last&&e.last.text.reversed.match(/(\n*)([^]*)/),d=f&&f[1];f&&(e.last.text=f[2].reversed);var h={},f=_.pluck["with"]("items",_.reject["with"](_.property("label"),_.partition3["with"](_.equals(h),_.scatter(e,function(a,b,c){_.each(a.text.split("\n"),function(b,e,f){c(_.extended(a,{text:b}));e!==f.lastIndex&&c(h)})})))),e=_.pluck(e,"text").join(""),g=a.where||log.impl.walkStack($callStack)||{},k=(a.indentPattern||"\t").repeats(a.indent);b({lines:f,config:a,color:a.color,when:(new Date).toISOString(),
args:_.reject(c,_.isTypeOf.$(log.Config)),indentation:k,indentedText:f.map(_.seq(_.pluck.tails2("text"),_.joinsWith(""),_.prepends(k))).join("\n"),text:e,codeLocation:a.location&&log.impl.location(g)||"",trailNewlines:d||"",where:a.location&&g||void 0});return _.find(c,_.not(_.isTypeOf.$(log.Config)))})),walkStack:function(b){return _.find(b.clean.offset($platform.Browser?1:2),function(b){return 0>b.fileShort.indexOf("base/log.js")})||b[0]},defaultWriteBackend:function(b){var c=b.codeLocation;if($platform.NodeJS){var a=
_.map(b.lines,function(a){return b.indentation+_.map(a,function(a){return a.config.color?a.config.color.shell+a.text+"\u001b[0m":a.text}).join("")}).join("\n");log.timestampEnabled&&(a=log.color("dark").shell+_.bullet(log.impl.timestamp(b.when)+" ",log.color("none").shell+a));console.log(a,log.color("dark").shell+c+"\u001b[0m",b.trailNewlines)}else console.log.apply(console,_.reject["with"](_.equals(void 0),[].concat([log.timestampEnabled?"%c"+log.impl.timestamp(b.when)+"%c":"",_.map(b.lines,function(a,
c){return b.indentation+_.reduce2("",a,function(a,b){return a+(b.text&&(b.config.color?"%c":"")+b.text||"")})}).join("\n"),c?"%c"+c:""].nonempty.join(" "),(log.timestampEnabled?["color:rgba(0,0,0,0.4)","color:black"]:[]).concat(_.scatter(b.lines,function(a,b,c){_.each(a,function(a){a.text&&a.config.color&&c(a.config.color.css)})})||[]).concat(c?"color:rgba(0,0,0,0.25)":[]),b.trailNewlines)))},timestamp:function(b){return b},location:function(b){return _.quoteWith("()",_.nonempty([b.calleeShort,_.nonempty([b.fileName,
b.line]).join(":")]).join(" @ "))},stringifyArguments:function(b,c){return _.map(b,function(a){a=log.impl.stringify(a,c);return c.maxArgLength?a.limitedTo(c.maxArgLength):a}).join(" ")},stringify:function(b,c){c=c||{};if(_.isTypeOf(Error,b)){var a=log.impl.stringifyError(b);return b.originalError?a+"\n\n"+log.impl.stringify(b.originalError):a}return _.isTypeOf(CallStack,b)?log.impl.stringifyCallStack(b):"object"===typeof b?_.isArray(b)&&1<b.length&&_.isObject(b[0])&&c.table?log.asTable(b):_.stringify(b,
c):"string"===typeof b?b:_.stringify(b)},stringifyError:function(b){try{var c=CallStack.fromErrorWithAsync(b).offset(b.stackOffset||0).clean;return"[EXCEPTION] "+(b.message||"").replace(/\r|\n/g,"").trimmed.limitedTo(120)+"\n\n"+(b.notMatching&&_.map(_.coerceToArray(b.notMatching||[]),log.impl.stringify.then(_.prepends("\t"))).join("\n")+"\n\n"||"")+log.impl.stringifyCallStack(c)+"\n"}catch(a){return"YO DAWG I HEARD YOU LIKE EXCEPTIONS... SO WE THREW EXCEPTION WHILE PRINTING YOUR EXCEPTION:\n\n"+
a.stack+"\n\nORIGINAL EXCEPTION:\n\n"+b.stack+"\n\n"}},stringifyCallStack:function(b){return log.columns(b.map(function(b){return["\tat "+b.calleeShort.first(30),_.nonempty([b.fileShort,":",b.line]).join(""),(b.source||"").first(80)]})).join("\n")}}});(function(){var b=log.impl.write;_.extend(log,log.printAPI=_.object(_.concat([["newline",b.$(log.config({location:!1}),"")],["write",b]],_.flat(_.map("red failure error e;blue info i;darkBlue minor m;orange warning warn w;green success ok g;darkGreen dg;pink notice alert p;boldPink pp;dark hint d;boldGreen gg;bright b;boldRed bloody bad ee;darkPink dp;brown br;darkOrange wtf;boldOrange ww;darkRed er;boldBlue ii".split(";"),
_.splitsWith(" ").then(_.mapsWith(function(c,a,e){return[c,b.$(log.config({location:0!==a,color:log.color(e.first),stackOffset:2}))]})))))))})();logs=_.mapWith(_.callsTo.compose(_.callsWith(log.stackOffset(1))),log.printAPI);_.extend(log,{asTable:function(b){var c=b.map(_.keys.arity1).reduce(_.union.arity2,[]);b=log.columns([c].concat(_.map(b,function(a){return c.map(_.propertyOf(a))})),{maxTotalWidth:120,minColumnWidths:c.map(_.property("length"))});return[b[0],log.thinLine[0].repeats(b[0].length),
_.rest(b)].flat.join("\n")},columns:function(b,c){if(0===b.length)return[];var a=b.map(_.map.tails2(function(a){return _.asString(a).split("\n")[0]})),e=a.map(_.map.tails2(_.property("length"))),f=e.zip(_.largest),d=c||{minColumnWidths:f,maxTotalWidth:0},h=_.reduce(f,_.sum,0),g=_.map(f,_.muls(1/h)),k=Math.max(0,h-d.maxTotalWidth),q=_.map(f,function(a,b){return Math.max(d.minColumnWidths[b],Math.floor(a-k*g[b]))}),e=e.map(function(a){return[q,a].zip(_.subtract)});return[a,e].zip(_.zap.tails(function(a,
b){return 0<=b?a+" ".repeats(b):_.initial(a,-b).join("")}).then(_.joinsWith("  ")))}});$platform.NodeJS&&(k.exports=log)},function(k,g){_.defineTagKeyword("shouldFail");_.defineTagKeyword("async");_.tests.Testosterone={async:function(b){_.delay(function(){b()})},$tests:function(){DummyPrototypeWithTest=$prototype({$test:function(){}});DummyPrototypeWithTests=$prototype({$tests:{dummy:function(){}}});$assertTypeMatches(DummyPrototypeWithTests.$tests,[{"*":"function"}]);$assertThrows(function(){DummyPrototypeWithTests.$tests=
42});$assertMatches(_.pluck(Testosterone.prototypeTests,"tests"),[DummyPrototypeWithTest.$tests,DummyPrototypeWithTests.$tests])}};_.defineTagKeyword("assertion");Testosterone=$singleton({prototypeTests:[],isRunning:$property(function(){return void 0!==this.currentAssertion}),constructor:function(){_.each(_.assertions,function(b,c){this.defineAssertion(c,"assertFails"===c?$shouldFail(function(a){a.call(this)}):b)},this);(function(b){$prototype.macro("$test",b);$prototype.macro("$tests",b)})(this.$(function(b,
c,a){this.prototypeTests.push({proto:b.constructor,tests:c});b.$tests=$static($property($constant(_.isStrictlyObject(c)&&c||_.object([["test",c]]))));return b}));this.run=this.$(this.run)},run:_.interlocked(function(b){var c=this.runConfig=_.extend({suites:[],silent:!0,verbose:!1,timeout:2E3,filter:_.identity,testStarted:function(a){},testComplete:function(a){}},b),a=_.isArray(c.suites),e=_.map(c.suites,this.$(function(b,e){return this.testSuite(a?b.name:e,a?b.tests:b,c.context,b.proto)}));return(!1===
c.codebase?__([]):this.collectPrototypeTests()).then(this.$(function(a){var b=!1===c.codebase?[]:this.collectTests();a=_.flatten(_.pluck(b.concat(e).concat(a),"tests"));a=_.filter(a,c.shouldRun||_.constant(!0));this.runningTests=_.map(a,function(a,b){return _.extend(a,{indent:c.indent,index:b})});_.each(this.runningTests,function(a){if(!(a.routine instanceof Function))throw log.ee(a.suite,a.name,"\u2013 test routine is not a function:",a.routine),Error();});this.runningTests=_.filter(this.runningTests,
c.filter||_.identity);return __.each(this.runningTests,this.$(this.runTest)).then(this.$(function(){_.assert(!0!==c.done);c.done=!0;this.printLog(c);this.failedTests=_.filter(this.runningTests,_.property("failed"));this.failed=0<this.failedTests.length;return!this.failed}))}))["catch"](function(a){log.margin();log.ee(log.boldLine,"TESTOSTERONE CRASHED",log.boldLine,"\n\n",a);throw a;})}),onException:function(b){if(this.currentAssertion)this.currentAssertion.onException(b);else throw b;},defineAssertions:function(b){_.each(b,
function(b,a){this.defineAssertion(a,b)},this)},runTest:function(b,c){var a=this.runConfig;log.impl.configStack=[];return __.then(a.testStarted(b),function(){b.verbose=a.verbose;b.timeout=a.timeout;b.startTime=Date.now();return b.run().then(function(){b.time=Date.now()-b.startTime;return a.testComplete(b)})})},collectTests:function(){return _.map(_.tests,this.$(function(b,c){return this.testSuite(c,b)}))},collectPrototypeTests:function(){var b=this;return __.map(this.prototypeTests,function(c,a){return c.proto.$meta.promise.then(function(a){return b.testSuite(a.name,
c.tests,void 0,c.proto)})})},testSuite:function(b,c,a,e){return{name:b||"",tests:_(_.pairs("function"===typeof c&&_.object([[b,c]])||c)).map(function(c){var d=new Test({proto:e,name:c[0],routine:c[1],suite:b,context:a});d.complete(function(){(d.hasLog=0<d.logCalls.length)||(d.failed?log.red("FAIL"):d.verbose&&log.green("PASS"))});return d})}},defineAssertion:function(b,c){var a=this;_.deleteKeyword(b);_.defineKeyword(b,Tags.modify(c,function(e){return _.withSameArgs(e,function(){var f=$callStack.safeLocation($platform.Browser&&
!$platform.Chrome?0:1);return a.currentAssertion?a.currentAssertion.babyAssertion(b,c,e,arguments,f):e.apply(a,arguments)})}))},printLog:function(b){if(!b.supressLog){var c=_.filter(this.runningTests,function(a){return a.failed||!b.silent&&a.hasLog}),a=_.filter(this.runningTests,_.property("failed"));_.invoke(b.verbose?this.runningTests:c,"printLog");a.length?log.orange("\n"+log.boldLine+"\nSOME TESTS FAILED:",_.pluck(a,"name").join(", "),"\n\n"):!0!==b.silent&&log.green("\n"+log.boldLine+"\nALL TESTS PASS\n\n")}}});
Test=$prototype({constructor:function(b){_.defaults(this,b,{name:"<< UNNAMED FOR UNKNOWN REASON >>",failed:!1,routine:void 0,verbose:!1,depth:1,indent:0,failedAssertions:[],context:this,complete:_.extend(_.barrier(),{context:this})});this.babyAssertion=_.interlocked(this.babyAssertion)},finalize:function(){this.babyAssertion.wait(this.$(function(){this.canFail&&this.failedAssertions.length&&(this.failed=!0);this.complete(!0)}))},babyAssertion:function(b,c,a,e,f){var d=this,h=new Test({mother:this,
name:b,shouldFail:c.$shouldFail||this.shouldFail,depth:this.depth+1,location:f,context:this.context,timeout:this.timeout/2,verbose:this.verbose,silent:this.silent,routine:Tags.modify(c,function(a){return function(b){if($async.is(e[0])||$async.is(c))_.cps.apply(a,d.context,e,function(a,c){c&&c.apply(this,a);b()});else try{a.apply(d.context,e),b()}catch(f){h.onException(f)}}})});return h.run()["finally"](function(a,b){Testosterone.currentAssertion=d;if(h.failed||h.verbose&&h.logCalls.notEmpty)return h.location.sourceReady.promise.then(function(a){log.red(log.config({location:h.location,
where:h.location}),a);h.evalLogCalls();return a})}).then(function(a){h.failed&&d.canFail&&d.failedAssertions.push(h)})},canFail:$property(function(){return!this.failed&&!this.shouldFail}),fail:function(){this.failed=!0;this.finalize()},assertionStack:$property(function(){var b=[],c=this;do b.push(c),c=c.mother;while(c);return b}),onException:function(b){if(this.canFail||this.verbose){if(_.isAssertionError(b)){if("notMatching"in b){var c=_.coerceToArray(b.notMatching);if(b.asColumns)log.orange(log.columns(_.map(c,
function(a){return["\t\u2022 "+_.keys(a)[0],_.stringify(_.values(a)[0])]})).join("\n"));else{b=_.map(c,log.impl.stringify.arity1.then(_.bullet.$("\t\u2022 ")));var a=_.reduce2(b,_.longestCommonSubstring)||"";4>a.length&&(a=void 0);_.each(b,function(b){if(a){var c=b.indexOf(a);log.write(log.color.orange,b.substr(0,c),log.color.dark,a,log.color.orange,b.substr(c+a.length))}else log.orange(b)})}}}else 1<this.depth&&log.newline(),log.write(b);log.newline()}this.canFail?this.fail():this.finalize()},run:function(){var b=
Testosterone.currentAssertion=this,c=Tags.unwrap(this.routine);return new Channel(this.$(function(a){this.shouldFail=$shouldFail.is(this.routine);this.hasLog=this.failed=!1;this.logCalls=[];this.failureLocations={};_.withTimeout({maxTime:b.timeout,expired:function(){b.canFail&&(log.ee("TIMEOUT EXPIRED"),b.fail())}},b.complete);_.withUncaughtExceptionHandler(b.$(b.onException),b.complete);log.withWriteBackend(_.extendWith({indent:1},function(a){b.logCalls.push(a)}),function(e){b.complete(e.arity0);
a&&b.complete(a);if(0<c.length)c.call(b.context,b.$(b.finalize));else{e=void 0;try{e=c.call(b.context)}catch(f){b.onException(f)}_.isArrayLike(e)&&e[0]instanceof Promise&&(e=__.all(e));e instanceof Promise?e.then(function(a){b.finalize()}.postponed,function(a){b.onException(a)}):b.finalize()}})}))},printLog:function(){var b=this.suite&&this.suite!==this.name&&(this.suite||"").quote("[]")||"";log.write(log.color.blue,"\n"+log.boldLine,"\n"+_.nonempty([b,this.name]).join(" "),(this.index+" of "+Testosterone.runningTests.length).quote("()")+
(this.failed?" FAILED":"")+":","\n");this.evalLogCalls()},evalLogCalls:function(){_.each(this.logCalls,log.writeBackend().arity1)}});_.defineTagKeyword("allowsRecursion");_.limitRecursion=function(b,c,a){c||(c=b,b=0);var e=-1,f=!1;return function(){if(!f){if(e>b)throw f=!0,_.extendWith({notMatching:_.map(arguments,function(a,b){return"arg"+(b+1)+": "+_.stringify(a)})},Error(a+": max recursion depth reached ("+b+")"));var d=(++e,c.apply(this,arguments));e--;return d}}};Testosterone.ValidatesRecursion=
$trait({$test:function(){var b=new ($component({$traits:[Testosterone.ValidatesRecursion],foo:function(){},bar:function(){this.bar()},baz:$allowsRecursion({max:2},function(){this.baz()}),qux:$allowsRecursion(function(){this.quxCalled||(this.quxCalled=!0,this.qux())})}));b.foo();$assertThrows(b.bar,{message:"bar: max recursion depth reached (0)"});b.bar();$assertThrows(b.baz,{message:"baz: max recursion depth reached (2)"});b.qux()},$constructor:function(){_.each(this,function(b,c){!_.isFunction($untag(b))||
"constructor"===c||b.$allowsRecursion&&void 0===b.$allowsRecursion.max||(this[c]=Tags.modify(b,function(a){return _.limitRecursion(b&&b.$allowsRecursion&&b.$allowsRecursion.max||0,a,c)}))},this)}});(function(){var b=_.keys(_.omit(log.color,"none"));b.each(_.defineTagKeyword);_.defineTagKeyword("verbose");Testosterone.LogsMethodCalls=$trait({$test:$platform.Browser?function(){}:function(b){var a=$prototype({$traits:[Testosterone.LogsMethodCalls]}),a=$extends(a,{foo:$log($pink($verbose(function(a){$assert(a,
42);return 24})))}),e=new a,f=this;a.$meta(function(){$assert(e.foo(42),24);$assert(_.pluck(f.logCalls,"text"),["Compo.foo (42)","\u2192 24",""]);$assert(f.logCalls[0].color===log.color("pink"));b()})},$macroTags:{log:function(c,a,e){var f=(_.isBoolean(a.$log)?void 0:a.$log)||(a.$verbose?"{{$proto}}":""),d={},h=_.find2(b,function(b){return log.color(a["$"+b]&&b)||!1}),g=f&&_.template(f,{interpolate:/\{\{(.+?)\}\}/g});$untag(c.$meta)(function(a){d=a});return $prototype.impl.modifyMember(a,function(b,
c){return function(){var f=this,k=_.asArray(arguments),r=g&&g.call(this,_.extend({$proto:d.name},_.map2(this,_.stringifyOneLine.arity1)))||this.desc||"",t=_.map(k,_.stringifyOneLine.arity1).join(", ").quote("()");log.write(log.config({color:h,location:!0,where:a.$verbose?void 0:{calleeShort:d.name}}),_.nonempty([r,e,c]).join("."),t);return log.withConfig({indent:1,color:h,protoName:d.name},function(){var a=log.impl.numWrites,c=b.apply(f,k);void 0!==c&&log.write("\u2192",_.stringifyOneLine(c));2>log.currentConfig().indent&&
0<log.impl.numWrites-a&&log.newline();return c})}})}}})})();$platform.NodeJS&&(k.exports=Testosterone)},function(k,g){_.measure=function(b,c){if(c){var a=_.now();b(function(){c(_.now()-a)})}else return a=_.now(),b(),_.now()-a};_.perfTest=function(b,c){var a=_.isFunction(b)?{test:b}:b,e={};_.cps.each(a,function(a,b,c){var g=[],k=function(){for(var c=0;500>c;c++)g.push(a());console.log(b,g)};k();_.delay(function(){e[b]=_.measure(k)/500;c()},100)},function(){c(e)})}},function(k,g){(function(b){"undefined"===
typeof UI&&(UI={});Panic=function(b,a){a=_.defaults(_.clone(a||{}),{dismiss:_.identity,raw:!1});_.isTypeOf(Error,b)&&_.extend(a,_.pick(b,"retry","dismiss"));Panic.widget.append(b,a.raw);if(_.isFunction(a.retry))Panic.widget.onRetry(a.retry);if(_.isFunction(a.dismiss))Panic.widget.onClose(a.dismiss)};Panic.init=function(){Panic._initialized||(Panic._initialized=!0,_.withUncaughtExceptionHandler(function(b){Panic(b);throw b;}))};Panic.widget=$singleton(Component,{retryTriggered:$triggerOnce(),closeTriggered:$triggerOnce(),
el:$memoized($property(function(){var c=b('<div class="panic-modal-overlay" style="z-index:5000; display:none;">').append([this.bg=b('<div class="panic-modal-overlay-background">'),this.modal=b('<div class="panic-modal">').append([this.modalBody=b('<div class="panic-modal-body">').append(this.title=b('<div class="panic-modal-title">Now panic!</div>')),b('<div class="panic-modal-footer">').append([this.btnRetry=b('<button type="button" class="panic-btn panic-btn-warning" style="display:none;">Try again</button>').touchClick(this.retry),
this.btnClose=b('<button type="button" class="panic-btn panic-btn-danger" style="display:none;">Close</button>').touchClick(this.close)])])]);c.appendTo(document.body);b(document).ready(function(){c.appendTo(document.body)});try{b(window).resize(this.layout).resize(),this.modal.enableScrollFaders({scroller:this.modalBody}),b(document).keydown(this.$(function(a){27===a.keyCode&&this.close()}))}catch(a){_.delay(function(){Panic(a)})}return c})),layout:function(){var c=_.coerceToUndefined(_.max(_.map(this.modal.find("pre"),
_.property("scrollWidth"))));this.modal.css({"max-height":b(window).height()-100,width:c&&c+120});this.modalBody.scroll()},toggleVisibility:function(b){b!==("none"!==this.el.css("display"))&&(b&&this.el.css("display",""),this.el.animateWith(b?"panic-modal-appear":"panic-modal-disappear",this.$(function(){b||this.el.css("display","none")})))},onRetry:function(b){this.retryTriggered(b);this.btnRetry.css("display","")},onClose:function(b){this.closeTriggered(b);this.btnClose.css("display","")},retry:function(){this._clean();
this.closeTriggered.off();this.toggleVisibility(!1);this.retryTriggered()},close:function(){this._clean();this.retryTriggered.off();this.toggleVisibility(!1);this.closeTriggered()},_clean:function(){this.modalBody.find(".panic-alert-error").remove();this.modalBody.scroll();this.btnRetry.css("display","none");this.btnClose.css("display","none")},append:function(c,a){var e="panic"+this.hash(c),f=b("#"+e+" .panic-alert-counter");f.length?f.text((f.text()||"1").parsedInt+1):b('<div class="panic-alert-error">').attr("id",
e).append('<span class="panic-alert-counter">').append(this.print(c,a)).insertAfter(this.el.find(".panic-modal-title"));this.toggleVisibility(!0);this.layout()},hash:function(b){return((_.isTypeOf(Error,b)?b&&b.stack:_.isTypeOf(Test,b)?b.suite+b.name:_.stringify(b))||"").hash},print:function(b,a){return _.isTypeOf(Error,b)?this.printError(b):_.isTypeOf(Test,b)?this.printFailedTest(b):this.printUnknownStuff(b,a)},printUnknownStuff:function(c,a){return a?c:b("<span>").text(log.impl.stringify(c))},printLocation:function(c){return b('<span class="location">').append([b('<span class="callee">').text(c.calleeShort),
b('<span class="file">').text(c.fileName),b('<span class="line">').text(c.line)])},printFailedTest:function(c){var a=b('<pre class="test-log" style="margin-top: 13px;">');log.withWriteBackend(this.$(function(c){_.isTypeOf(Error,c.args.first)&&console.log(c.args.first);a.append(_.isTypeOf(Error,c.args.first)?b('<div class="inline-exception-entry">').append([_.escape(c.indentation),b('<div class="panic-alert-error inline-exception">').append(this.printError(c.args.first))]):b('<div class="log-entry">').append(_.map(c.lines,
function(a,d,h){return b('<div class="line">').append(_.escape(c.indentation)).append(_.map(a,function(a){return b("<span>").attr("style",a.config.color&&a.config.color.css||"").text(a.text)})).append(d===h.lastIndex?[c.where&&this.printLocation(c.where),c.trailNewlines.replace(/\n/g,"<br>")]:[])},this)))}),function(a){c.evalLogCalls();a()});return[b('<div class="panic-alert-error-message" style="font-weight: bold;">').text(c.name).append('<span style="float:right; opacity: 0.25;">test failed</span>'),
a]},printError:function(c){var a=CallStack.fromErrorWithAsync(c);return[b('<div class="panic-alert-error-message" style="font-weight: bold;">').text(c.message).append(_.any(a,function(a,b){return(a.thirdParty||a["native"]||a.hide)&&0!==b})?'<a class="clean-toggle" href="javascript:{}"></a>':"").click(this.$(function(a){b(a.delegateTarget).parent().toggleClass("all-stack-entries").transitionend(this.$(function(){this.modalBody.scroll()}))})),b('<div class="not-matching" style="margin-top: 5px; padding-left: 10px;">').append(_.map(_.coerceToArray(c.notMatching||
[]),function(a){return b("<pre>").text(log.impl.stringify(a))})),b('<ul class="callstack">').append(_.map(a,this.$(function(a){var c=b('<li class="callstack-entry">').toggleClass("third-party",a.thirdParty||!1).toggleClass("hide",a.hide||!1).toggleClass("native",a["native"]||!1).append([b('<span class="file">').text(_.nonempty([a.index?"(index)":a.fileShort,a.line]).join(":")),b('<span class="callee">').text(a.calleeShort),b('<span class="src i-am-busy">').click(this.$(function(d){var h=b(d.delegateTarget);
h.waitUntil(SourceFiles.read.partial((a.remote?"api/source/":"")+a.file),this.$(function(d){c.is(".full")?(c.removeClass("full"),c.transitionend(function(){c.is(".full")||a.sourceReady(h.$(b.fn.text))})):(c.addClass("full"),h.html(_.map(d.split("\n"),function(a){return b('<div class="line">').text(a)})),d=h.find(".line").eq(a.line-1).addClass("hili"),d.length&&(d=d.offset().top-h.offset().top,h.scrollTop(d-100)),_.delay(this.$(function(){var a=h.outerBBox().bottom+242-this.modalBody.outerBBox().bottom;
0<a&&this.modalBody.animate({scrollTop:this.modalBody.scrollTop()+a},250)})))}))}))]);a.sourceReady(function(a){c.find(".src").removeClass("i-am-busy").text(a)});return c})))]}});b.fn.extend({enableScrollFaders:function(c){var a=c&&c.horizontal,e,f;c=this.find(c&&c.scroller||".scroller");this.css({position:"relative"});this.append(e=b('<div class="scroll-fader scroll-fader-'+(a?"left":"top")+'"></div>')).append(f=b('<div class="scroll-fader scroll-fader-'+(a?"right":"bottom")+'"></div>'));c.scroll(function(){var c=
a?b(this).scrollLeft():b(this).scrollTop(),h=a?b(this).width():b(this).height(),g=(a?this.scrollWidth:this.scrollHeight)-1;e.css({opacity:0<c?1:0});f.css({opacity:c+h<g?1:0})}).scroll();return this}})})(jQuery)},function(k,g){(function(b){LogOverlay=$singleton(Component,{$defaults:{opaque:!1},init:function(){log.withWriteBackend(this.write,function(){});b(document).keydown(this.$(function(b){192===b.keyCode?this.toggle():27===b.keyCode&&this.body.empty()}))},el:$memoized($property(function(){return b('<div class="useless-log-overlay" style="display: none;">').append('<div class="useless-log-overlay-body">').appendTo(document.body)})),
body:$memoized($property(function(){return this.el.find(".useless-log-overlay-body")})),toggle:function(b){this.el.toggle(b)},visible:$property(function(){return this.el.is(":visible")}),clip:function(){var c=this.el.height(),a=this.body.height();this.body.children().filter(this.$(function(e,f){var d=a-b(f).offsetInParent().y,h=d-b(f).height(),g=c/2;return d>g&&h>g})).remove()},write:function(c){this.toggle(!0);c.config.clear&&this.body.empty();this.body.append(b('<div class="ulo-line">').attr("style",
c.color&&c.color.css||"").append(b('<span class="ulo-line-text">').text(c.indentedText+" ")).append(b('<span class="ulo-line-where">').text(c.codeLocation+" ")).append(b('<span class="ulo-line-trail">').text(c.trailNewlines)));this.clip.postpone();this.opaque||log.impl.defaultWriteBackend(c)}})})(jQuery)},function(k,g,b){g=b(12);"string"===typeof g&&(g=[[k.id,g,""]]);b(14)(g,{});g.locals&&(k.exports=g.locals)},function(k,g,b){g=k.exports=b(13)();g.push([k.id,"@-webkit-keyframes bombo-jumbo {\n  0%   { -webkit-transform: scale(0); }\n  80%  { -webkit-transform: scale(1.2); }\n  100% { -webkit-transform: scale(1); } }\n\n@keyframes bombo-jumbo {\n  0%   { transform: scale(0); }\n  80%  { transform: scale(1.2); }\n  100% { transform: scale(1); } }\n\n@-webkit-keyframes pulse-opacity {\n  0% { opacity: 0.5; }\n  50% { opacity: 0.25; }\n  100% { opacity: 0.5; } }\n\n@keyframes pulse-opacity {\n  0% { opacity: 0.5; }\n  50% { opacity: 0.25; }\n  100% { opacity: 0.5; } }\n\n.i-am-busy { -webkit-animation: pulse-opacity 1s ease-in infinite; animation: pulse-opacity 1s ease-in infinite; pointer-events: none; }\n\n.panic-modal .scroll-fader-top, .scroll-fader-bottom { left: 42px; right: 42px; position: absolute; height: 20px; pointer-events: none; }\n.panic-modal .scroll-fader-top { top: 36px; background: -webkit-linear-gradient(bottom, rgba(255,255,255,0), rgba(255,255,255,1)); }\n.panic-modal .scroll-fader-bottom { bottom: 128px; background: -webkit-linear-gradient(top, rgba(255,255,255,0), rgba(255,255,255,1)); }\n\n.panic-modal-appear {\n  -webkit-animation: bombo-jumbo 0.25s cubic-bezier(1,.03,.48,1);\n  animation: bombo-jumbo 0.25s cubic-bezier(1,.03,.48,1); }\n\n.panic-modal-disappear {\n  -webkit-animation: bombo-jumbo 0.25s cubic-bezier(1,.03,.48,1); -webkit-animation-direction: reverse;\n  animation: bombo-jumbo 0.25s cubic-bezier(1,.03,.48,1); animation-direction: reverse; }\n\n.panic-modal-overlay {\n          display: -ms-flexbox; display: -moz-flex; display: -webkit-flex; display: flex;\n          -ms-flex-direction: column; -moz-flex-direction: column; -webkit-flex-direction: column; flex-direction: column;\n          -ms-align-items: center; -moz-align-items: center; -webkit-align-items: center; align-items: center;\n          -ms-flex-pack: center; -ms-align-content: center; -moz-align-content: center; -webkit-align-content: center; align-content: center;\n          -ms-justify-content: center; -moz-justify-content: center; -webkit-justify-content: center; justify-content: center;\n          position: fixed; left: 0; right: 0; top: 0; bottom: 0; }\n\n.panic-modal-overlay-background { z-index: 1; position: absolute; left: 0; right: 0; top: 0; bottom: 0; background: white; opacity: 0.75; }\n\n.panic-modal * { letter-spacing: 0; font-family: Helvetica, sans-serif; }\n.panic-modal { font-family: Helvetica, sans-serif; min-width: 640px; max-width: 90%; transition: 0.25s width ease-in-out; box-sizing: border-box; display: -webkit-flex; display: flex; position: relative; border-radius: 4px; z-index: 2; width: 640px; background: white; padding: 36px 42px 128px 42px; box-shadow: 0px 30px 80px rgba(0,0,0,0.25), 0 1px 2px rgba(0,0,0,0.15); }\n.panic-alert-counter { float: left; background: #904C34; border-radius: 8px; width: 17px; height: 17px; display: inline-block; text-align: center; line-height: 16px; margin-right: 1em; margin-left: -2px; font-size: 10px; color: white; font-weight: bold; }\n.panic-alert-counter:empty { display: none; }\n\n.panic-modal-title { font-family: Helvetica, sans-serif; color: black; font-weight: 300; font-size: 30px; opacity: 0.5; margin-bottom: 1em; }\n.panic-modal-body { overflow-y: auto; width: 100%; }\n.panic-modal-footer { text-align: right; position: absolute; left: 0; right: 0; bottom: 0; padding: 42px; }\n\n.panic-btn { margin-left: 1em; font-weight: 300; font-family: Helvetica, sans-serif; -webkit-user-select: none; user-select: none; cursor: pointer; display: inline-block; padding: 1em 1.5em; border-radius: 4px; font-size: 14px; border: 1px solid black; color: white; }\n.panic-btn:focus { outline: none; }\n.panic-btn:focus { box-shadow: inset 0px 2px 10px rgba(0,0,0,0.25); }\n\n.panic-btn-danger       { background-color: #d9534f; border-color: #d43f3a; }\n.panic-btn-danger:hover { background-color: #c9302c; border-color: #ac2925; }\n\n.panic-btn-warning       { background-color: #f0ad4e; border-color: #eea236; }\n.panic-btn-warning:hover { background-color: #ec971f; border-color: #d58512; }\n\n.panic-alert-error { border-radius: 4px; background: #FFE8E2; color: #904C34; padding: 1em 1.2em 1.2em 1.2em; margin-bottom: 1em; font-size: 14px; }\n\n.panic-alert-error { position: relative; text-shadow: 0px 1px 0px rgba(255,255,255,0.25); }\n\n.panic-alert-error .clean-toggle { height: 2em; text-decoration: none; font-weight: 300; position: absolute; color: black; opacity: 0.25; right: 0; top: 0; display: block; text-align: right; }\n.panic-alert-error .clean-toggle:hover { text-decoration: underline; }\n.panic-alert-error .clean-toggle:before,\n.panic-alert-error .clean-toggle:after { position: absolute; right: 0; transition: all 0.25s ease-in-out; display: inline-block; overflow: hidden; }\n.panic-alert-error .clean-toggle:before { -webkit-transform-origin: center left; transform-origin: center left; content: 'more'; }\n.panic-alert-error .clean-toggle:after { -webkit-transform-origin: center left; transform-origin: center right; content: 'less'; }\n.panic-alert-error.all-stack-entries .clean-toggle:before { -webkit-transform: scale(0); transform: scale(0); }\n.panic-alert-error:not(.all-stack-entries) .clean-toggle:after { -webkit-transform: scale(0); transform: scale(0); }\n\n.panic-alert-error:last-child { margin-bottom: 0; }\n\n.panic-alert-error-message { line-height: 1.2em; position: relative; }\n\n.panic-alert-error .callstack { font-size: 12px; margin: 2em 0 0.1em 0; padding: 0; }\n.panic-alert-error .callstack * { font-family: Menlo, monospace; }\n\n.panic-alert-error .callstack-entry { white-space: nowrap; opacity: 1; transition: all 0.25s ease-in-out; margin-top: 10px; list-style-type: none; max-height: 38px; overflow: hidden; }\n.panic-alert-error .callstack-entry .file { }\n.panic-alert-error .callstack-entry .file:not(:empty) + .callee:not(:empty):before { content: ' \\2192   '; }\n\n.panic-alert-error:not(.all-stack-entries) > .callstack > .callstack-entry.third-party:not(:first-child),\n.panic-alert-error:not(.all-stack-entries) > .callstack > .callstack-entry.hide:not(:first-child),\n.panic-alert-error:not(.all-stack-entries) > .callstack > .callstack-entry.native:not(:first-child) { max-height: 0; margin-top: 0; opacity: 0; }\n\n.panic-alert-error .callstack-entry,\n.panic-alert-error .callstack-entry * { line-height: initial; }\n.panic-alert-error .callstack-entry .src { overflow: hidden; transition: height 0.25s ease-in-out; height: 22px; border-radius: 2px; cursor: pointer; margin-top: 2px; white-space: pre; display: block; color: black; background: rgba(255,255,255,0.75); padding: 4px; }\n.panic-alert-error .callstack-entry.full .src { font-size: 12px; height: 200px; overflow: scroll; }\n.panic-alert-error .callstack-entry.full .src .line.hili { background: yellow; }\n.panic-alert-error .callstack-entry.full { max-height: 220px; }\n\n.panic-alert-error .callstack-entry .src.i-am-busy { background: white; }\n\n.panic-alert-error .callstack-entry        .src:empty                  { pointer-events: none; }\n.panic-alert-error .callstack-entry        .src:empty:before           { content: '<< SOURCE NOT LOADED >>'; color: rgba(0,0,0,0.25); }\n.panic-alert-error .callstack-entry.native .src:empty:before           { content: '<< NATIVE CODE >>'; color: rgba(0,0,0,0.25); }\n.panic-alert-error .callstack-entry        .src.i-am-busy:empty:before { content: '<< SOURCE LOADING >>'; color: rgba(0,0,0,0.5); }\n\n.panic-alert-error .test-log .location { transition: opacity 0.25s ease-in-out; color: black; opacity: 0.25; display: inline-block; overflow: hidden; text-overflow: ellipsis; vertical-align: middle; }\n.panic-alert-error .test-log .location:hover { opacity: 1; }\n\n.panic-alert-error .test-log .location:before { content: ' @ '; }\n\n.panic-alert-error .test-log .location .callee:after  { content: ', '; }\n.panic-alert-error .test-log .location .file          { opacity: 0.5; }\n.panic-alert-error .test-log .location .line:before   { content: ':'; }\n.panic-alert-error .test-log .location .line          { opacity: 0.25; }\n\n/*  Hack to prevent inline-blocked divs from wrapping within white-space: pre;\n */\n.panic-alert-error .test-log .inline-exception-entry:after { content: ' '; }\n.panic-alert-error .test-log .log-entry        .line:after { content: ' '; }\n.panic-alert-error           .callstack-entry  .line:after { content: ' '; }\n\n.panic-alert-error pre { overflow: scroll; border-radius: 2px; color: black; background: rgba(255,255,255,0.75); padding: 4px; margin: 0; }\n.panic-alert-error pre,\n.panic-alert-error pre * { font-family: Menlo, monospace; font-size: 11px; white-space: pre !important; }\n\n.panic-alert-error.inline-exception { max-width: 640px; border-radius: 0; margin: 0; background: none; display: inline-block; transform-origin: 0 0; transform: scale(0.95); }\n.panic-alert-error.inline-exception .panic-alert-error-message { cursor: pointer; }\n.panic-alert-error.inline-exception:not(:first-child) { margin-top: 10px; border-top: 1px solid #904C34; }\n\n",
""])},function(k,g){k.exports=function(){var b=[];b.toString=function(){for(var b=[],a=0;a<this.length;a++){var e=this[a];e[2]?b.push("@media "+e[2]+"{"+e[1]+"}"):b.push(e[1])}return b.join("")};b.i=function(c,a){"string"===typeof c&&(c=[[null,c,""]]);for(var e={},f=0;f<this.length;f++){var d=this[f][0];"number"===typeof d&&(e[d]=!0)}for(f=0;f<c.length;f++)d=c[f],"number"===typeof d[0]&&e[d[0]]||(a&&!d[2]?d[2]=a:a&&(d[2]="("+d[2]+") and ("+a+")"),b.push(d))};return b}},function(k,g,b){function c(a,
b){for(var c=0;c<a.length;c++){var f=a[c],e=p[f.id];if(e){e.refs++;for(var d=0;d<e.parts.length;d++)e.parts[d](f.parts[d]);for(;d<f.parts.length;d++)e.parts.push(l(f.parts[d],b))}else{e=[];for(d=0;d<f.parts.length;d++)e.push(l(f.parts[d],b));p[f.id]={id:f.id,refs:1,parts:e}}}}function a(a){for(var b=[],c={},f=0;f<a.length;f++){var d=a[f],e=d[0],d={css:d[1],media:d[2],sourceMap:d[3]};c[e]?c[e].parts.push(d):b.push(c[e]={id:e,parts:[d]})}return b}function e(a,b){var c=t(),d=n[n.length-1];if("top"===
a.insertAt)d?d.nextSibling?c.insertBefore(b,d.nextSibling):c.appendChild(b):c.insertBefore(b,c.firstChild),n.push(b);else if("bottom"===a.insertAt)c.appendChild(b);else throw Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");}function f(a){a.parentNode.removeChild(a);a=n.indexOf(a);0<=a&&n.splice(a,1)}function d(a){var b=document.createElement("style");b.type="text/css";e(a,b);return b}function h(a){var b=document.createElement("link");b.rel="stylesheet";e(a,b);return b}
function l(a,b){var c,e,g;if(b.singleton){var k=w++;c=u||(u=d(b));e=m.bind(null,c,k,!1);g=m.bind(null,c,k,!0)}else a.sourceMap&&"function"===typeof URL&&"function"===typeof URL.createObjectURL&&"function"===typeof URL.revokeObjectURL&&"function"===typeof Blob&&"function"===typeof btoa?(c=h(b),e=v.bind(null,c),g=function(){f(c);c.href&&URL.revokeObjectURL(c.href)}):(c=d(b),e=q.bind(null,c),g=function(){f(c)});e(a);return function(b){b?b.css===a.css&&b.media===a.media&&b.sourceMap===a.sourceMap||e(a=
b):g()}}function m(a,b,c,d){c=c?"":d.css;a.styleSheet?a.styleSheet.cssText=x(b,c):(c=document.createTextNode(c),d=a.childNodes,d[b]&&a.removeChild(d[b]),d.length?a.insertBefore(c,d[b]):a.appendChild(c))}function q(a,b){var c=b.css,d=b.media;d&&a.setAttribute("media",d);if(a.styleSheet)a.styleSheet.cssText=c;else{for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(c))}}function v(a,b){var c=b.css,d=b.sourceMap;d&&(c+="\n/*# sourceMappingURL=data:application/json;base64,"+
btoa(unescape(encodeURIComponent(JSON.stringify(d))))+" */");c=new Blob([c],{type:"text/css"});d=a.href;a.href=URL.createObjectURL(c);d&&URL.revokeObjectURL(d)}var p={};g=function(a){var b;return function(){"undefined"===typeof b&&(b=a.apply(this,arguments));return b}};var r=g(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),t=g(function(){return document.head||document.getElementsByTagName("head")[0]}),u=null,w=0,n=[];k.exports=function(b,d){d=d||{};"undefined"===
typeof d.singleton&&(d.singleton=r());"undefined"===typeof d.insertAt&&(d.insertAt="bottom");var e=a(b);c(e,d);return function(b){for(var f=[],g=0;g<e.length;g++){var h=p[e[g].id];h.refs--;f.push(h)}b&&(g=a(b),c(g,d));for(g=0;g<f.length;g++)if(h=f[g],0===h.refs){for(b=0;b<h.parts.length;b++)h.parts[b]();delete p[h.id]}}};var x=function(){var a=[];return function(b,c){a[b]=c;return a.filter(Boolean).join("\n")}}()},function(k,g,b){g=b(16);"string"===typeof g&&(g=[[k.id,g,""]]);b(14)(g,{});g.locals&&
(k.exports=g.locals)},function(k,g,b){g=k.exports=b(13)();g.push([k.id,".useless-log-overlay {\tposition: fixed; bottom: 10px; left: 10px; right: 10px; top: 10px; z-index: 5000;\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\tpointer-events: none;\n\t\t\t\t\t\t-webkit-mask-image: -webkit-gradient(linear, left top, left bottom,\n\t\t\t\t\t\t\tcolor-stop(0.00, rgba(0,0,0,0)),\n\t\t\t\t\t\t\tcolor-stop(0.50, rgba(0,0,0,0)),\n\t\t\t\t\t\t\tcolor-stop(0.60, rgba(0,0,0,0.8)),\n\t\t\t\t\t\t\tcolor-stop(1.00, rgba(0,0,0,1))); }\n\n.useless-log-overlay-body {\n\n\tfont-family: Menlo, monospace;\n\tfont-size: 11px;\n\twhite-space: pre;\n\tbackground: rgba(255,255,255,1);\n\ttext-shadow: 1px 1px 0px rgba(0,0,0,0.07); position: absolute; bottom: 0; left: 0; right: 0; }\n\n.ulo-line \t\t{ white-space: pre; word-wrap: normal; }\n.ulo-line-where { color: black; opacity: 0.25; }",
""])}]);
